(this.webpackJsonpmiles=this.webpackJsonpmiles||[]).push([[0],{156:function(e,t){},207:function(e,t,n){e.exports=n.p+"static/media/takeoff-ticket.0418c8df.svg"},236:function(e,t,n){e.exports=n(417)},242:function(e,t,n){},252:function(e,t){},254:function(e,t){},317:function(e,t){},319:function(e,t){},329:function(e,t){},331:function(e,t){},356:function(e,t){},357:function(e,t){},380:function(e,t){},417:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),i=n(15),l=n.n(i),r=(n(97),n(13)),c=n(60),s=n.n(c),u=n(86),m=(n(242),n(207)),p=n.n(m),d=[{field:"id",headerName:"ID",width:100},{field:"amount",headerName:"Amount",width:100},{field:"expiration",headerName:"Expiration",width:300}],h=[{pid:"P001",image:"tezos-case.jpg",title:"Tezos Phone Case",nbmiles:5,got:!1},{pid:"P002",image:"archetype-mug.jpg",title:"Archetype Mug",nbmiles:3,got:!1},{pid:"P003",image:"tezos-sweats.jpg",title:"Tezos Sweat",nbmiles:8,got:!1},{pid:"P004",image:"archetype-cap.png",title:"Archetype Cap",nbmiles:2,got:!1},{pid:"P005",image:"tezos-cap.png",title:"Tezos Cap",nbmiles:2,got:!1}],f=n(472),E=n(474),g=n(226),b=n(471),v=n(475),w=n(212),y=n.n(w),x=function(e){var t=Object(b.a)("(min-width:600px)")?"visible":"hidden",n="dark"===e.theme.palette.type;return o.a.createElement(f.a,{position:"static",color:n?"inherit":"secondary",style:{boxShadow:"none",opacity:1}},o.a.createElement(E.a,null,o.a.createElement(g.a,{variant:"h6",style:{position:"absolute",fontFamily:"Alegreya Sans SC, sans-serif"}},"Completium"),o.a.createElement(g.a,{variant:"h6",style:{flexGrow:1,visibility:t}},e.appTitle),o.a.createElement("a",{href:"https://edukera.github.io/completium-landing/docs/dapp-miles/miles-use-case1",target:"_blank"},o.a.createElement(v.a,{style:{color:"white"},component:"span"},o.a.createElement(y.a,null)))))},k=n(477),M=n(479),C=n(476),j=n(225),S=function(e){var t=new Date(e)-+new Date,n={};return t>0&&(n={days:Math.floor(t/864e5),hours:Math.floor(t/36e5%24),minutes:Math.floor(t/1e3/60%60),seconds:Math.floor(t/1e3%60)}),n},z=function(e){var t=Object(a.useState)(S(e.expiration)),n=Object(r.a)(t,2),i=n[0],l=n[1];Object(a.useEffect)((function(){var t=setTimeout((function(){l(S(e.expiration))}),1e3);return function(){return clearTimeout(t)}}));var c=[];return Object.keys(i).forEach((function(e){i[e]&&c.push(o.a.createElement("span",null,i[e]," ",e," "))})),o.a.createElement(g.a,{color:"error"},c.length?c:o.a.createElement("span",null,"Time's up!"))},O=n(215),T=n(129),N=Object(O.a)((function(e){var t=e.appName,n=o.a.useState((function(){return{wallet:null,tezos:null,accountPkh:null}})),a=Object(r.a)(n,2),i=a[0],l=i.wallet,c=i.tezos,m=i.accountPkh,p=a[1],d=Boolean(c);o.a.useEffect((function(){return T.a.onAvailabilityChange((function(e){p({wallet:e?new T.a(t):null,tezos:null,accountPkh:null})}))}),[p,t]);var h=o.a.useCallback(function(){var e=Object(u.a)(s.a.mark((function e(t,n){var a,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,l){e.next=3;break}throw new Error("Thanos Wallet not available");case 3:return e.next=5,l.connect(t,n);case 5:return a=l.toTezos(),e.next=8,a.wallet.pkh();case 8:o=e.sent,p({wallet:l,tezos:a,accountPkh:o}),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),alert("Failed to connect ThanosWallet: ".concat(e.t0.message));case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t,n){return e.apply(this,arguments)}}(),[p,l]);return{wallet:l,tezos:c,accountPkh:m,ready:d,connect:h}}),(function(e){return e.wallet}),(function(e){return e.tezos}),(function(e){return e.accountPkh}),(function(e){return e.ready}),(function(e){return e.connect})),P=Object(r.a)(N,6),B=P[0],G=P[1],A=P[2],D=P[3],W=P[4],I=P[5];var R=n(478),V=function(e){var t=D(),n=A();return Object(a.useEffect)((function(){n.wallet.at("KT1F5DqPwKJC9qeEjTgdEQKGGBZpcAv5DX86").then((function(n){n.storage().then((function(a){var o=[];a.owner.has(t)&&a.owner.get(t).forEach((function(e){var t=a.mile.get(e);o.push({id:e,amount:t.amount,expiration:t.expiration})})),e.handleMiles(n,o)}))}))}),[e.nbMiles]),o.a.createElement(C.a,{style:{height:"300px"}},o.a.createElement(C.a,{style:{height:"120px"}}),o.a.createElement(j.a,{style:{opacity:.8,paddingLeft:18,paddingRight:18}},null===e.nbMiles?o.a.createElement(k.a,{container:!0,direction:"row",alignItems:"center",spacing:2,style:{height:64}},o.a.createElement(k.a,{item:!0,xs:12},o.a.createElement(R.a,{color:"secondary"}))):o.a.createElement(k.a,{container:!0,direction:"row",alignItems:"center",spacing:2},o.a.createElement(k.a,{item:!0,xs:2,direction:"row"},o.a.createElement(g.a,{color:"textSecondary"},"Active Miles:"),o.a.createElement(g.a,null,e.nbMiles)),o.a.createElement(k.a,{item:!0,xs:8},o.a.createElement(g.a,{color:"textSecondary"},"Time before next mile expiration:"),o.a.createElement(z,{expiration:e.nextExpiration})),o.a.createElement(k.a,{item:!0,xs:2},o.a.createElement(v.a,{onClick:e.openViewMiles},"View Miles")))))},F=function(e){var t=W(),n=G();return t?o.a.createElement(V,{nbMiles:e.nbMiles,nextExpiration:e.nextExpiration,handleConnect:e.handleConnect,openViewMiles:e.openViewMiles,miles:e.miles,handleMiles:e.handleMiles}):o.a.createElement(k.a,{container:!0,direction:"column",style:{height:"300px"}},o.a.createElement(k.a,{item:!0,xs:12},n?o.a.createElement(v.a,{variant:"contained",size:"medium",color:"secondary",style:{marginTop:"125px"},disableElevation:!0,onClick:e.handleConnect},"connect to wallet"):o.a.createElement(M.a,{href:"https://thanoswallet.com/",rel:"noopener",underline:"none"},o.a.createElement(v.a,{variant:"contained",size:"medium",style:{marginTop:"125px",backgroundColor:"#ed8936",color:"white",fontWeight:"bold"},disableElevation:!0},"Install Thanos"))))},J=n(419),K=n(480),q=n(481),H=n(484),L=n(483),Q=n(482),U=Object(J.a)({root:{maxWidth:345},media:{height:240}});function X(e){return e.connected?e.state?o.a.createElement(v.a,{variant:"contained",size:"medium",color:"secondary",disableElevation:!0,style:{flexGrow:1},onClick:function(){e.contract.methods.consume(e.nbmiles).send().then((function(t){console.log("waiting for ".concat(t.opHash," to be confirmed")),e.openSnack(),t.receipt().then((function(){e.handleReceipt()}))}))}},"Get it!"):o.a.createElement(v.a,{variant:"contained",size:"medium",disableElevation:!0,style:{flexGrow:1},disabled:!0},"Not Enough Miles"):o.a.createElement(v.a,{variant:"contained",size:"medium",color:"secondary",disableElevation:!0,style:{flexGrow:1},disabled:!0},"Get it!")}function Y(e){var t=U();return o.a.createElement(K.a,{className:t.root},o.a.createElement(q.a,null,o.a.createElement(Q.a,{className:t.media,image:"/completium-dapp-miles/img/"+e.image,title:e.title}),o.a.createElement(L.a,null,o.a.createElement(g.a,{gutterBottom:!0,variant:"body2",component:"h2"},"Nb. miles: ",e.nbmiles),o.a.createElement(g.a,{variant:"body2",color:"textSecondary",component:"p"},e.title))),o.a.createElement(H.a,null,o.a.createElement(X,{state:e.state,connected:e.connected,contract:e.contract,nbmiles:e.nbmiles,handleReceipt:e.handleReceipt,openSnack:e.openSnack})))}var Z=n(222),$=n(489),_=n(490),ee=function(e){return o.a.createElement(f.a,{position:"static",color:"default",style:{boxShadow:"none",opacity:1,heigh:300}},o.a.createElement(E.a,{style:{minHeight:256}},o.a.createElement(g.a,{variant:"body2",color:"textSecondary",style:{flexGrow:1}},"@copyright MilesCorp. 2021")))},te=n(493),ne=n(4),ae=n(487),oe=n(488),ie=n(227),le=n(221),re=n.n(le),ce=n(216),se=Object(ne.a)((function(e){return{root:{margin:0,padding:e.spacing(2),backgroundColor:"light"===e.palette.type?e.palette.background.default:"#212121"},closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),color:e.palette.grey[500]}}}))((function(e){var t=e.children,n=e.classes,a=e.onClose;return o.a.createElement(ae.a,{disableTypography:!0,className:n.root},o.a.createElement(g.a,{variant:"h6"},t),o.a.createElement(ie.a,{"aria-label":"close",className:n.closeButton,onClick:a},o.a.createElement(re.a,null)))})),ue=Object(ne.a)((function(e){return{root:{padding:e.spacing(2)}}}))(oe.a),me=function(e){return o.a.createElement(te.a,{open:e.open,onClose:e.onclose},o.a.createElement(se,{id:"customized-dialog-title",onClose:e.onclose},"Miles"),o.a.createElement(ue,{dividers:!0,style:{height:410,width:550,backgroundColor:"light"===e.theme.palette.type?e.theme.palette.background.default:"#212121"}},o.a.createElement(ce.a,{rows:e.miles,columns:d,pageSize:4})))},pe=n(494),de=n(491);function he(e){return o.a.createElement(de.a,Object.assign({elevation:6,variant:"filled"},e))}var fe=function(e){return o.a.createElement(pe.a,{open:e.open},o.a.createElement(he,{severity:"info",style:{backgroundColor:e.theme.palette.secondary.main}},"Waiting for operation confirmation ..."))},Ee=n(14);function ge(){var e=W(),t=I(),n=o.a.useCallback(Object(u.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t("delphinet");case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),alert(e.t0.message);case 8:case 9:case"end":return e.stop()}}),e,null,[[0,5]])}))),[t]),a=o.a.useState(null),i=Object(r.a)(a,2),l=i[0],c=i[1],m=o.a.useState(null),d=Object(r.a)(m,2),f=d[0],E=d[1],g=o.a.useState(!1),b=Object(r.a)(g,2),v=b[0],w=b[1],y=o.a.useState(!1),M=Object(r.a)(y,2),j=M[0],S=M[1],z=function(e){if(null===e)return null;var t=new Ee.BigNumber("0");return e.forEach((function(e){t=t.plus(e.amount)})),t.toNumber()}(f),O=function(e){if(null==e||0===e.length)return null;var t=new Date(864e13);return e.forEach((function(e){var n=new Date(e.expiration);n>=Date.now()&&n<=t&&(t=n)})),t}(f),T=function(e,t){console.log(e);var n=[];return h.forEach((function(a){n[a.pid]=e&&t>=a.nbmiles})),n}(e,z),N=o.a.useMemo((function(){return Object(Z.a)({palette:{type:"light"}})}),[!1]),P=function(){S(!1),E(null)},B=function(){S(!0)};return o.a.createElement("div",{className:"App"},o.a.createElement($.a,{theme:N},o.a.createElement(_.a,null),o.a.createElement(x,{appTitle:"Use Your Miles Before Expiration!",theme:N}),o.a.createElement(C.a,{maxWidth:"md",style:{backgroundImage:"url("+p.a+")",backgroundRepeat:"no-repeat",backgroundPosition:"right 50% top 5%"}},o.a.createElement(F,{nbMiles:z,nextExpiration:O,handleConnect:n,openViewMiles:function(){w(!0)},miles:f,handleMiles:function(e,t){c(e),E(t)}}),o.a.createElement(k.a,{container:!0,direction:"row",spacing:2,style:{marginBottom:100}}," ",h.map((function(t){return o.a.createElement(k.a,{item:!0,xs:4},o.a.createElement(Y,{image:t.image,title:t.title,nbmiles:t.nbmiles,state:T[t.pid],connected:e,contract:l,handleReceipt:P,openSnack:B}))})))),o.a.createElement(ee,null),o.a.createElement(me,{open:v,onclose:function(){w(!1)},theme:N,miles:f}),o.a.createElement(fe,{open:j,theme:N})))}var be=function(){return o.a.createElement(B,{appName:"MilesCorp."},o.a.createElement(o.a.Suspense,{fallback:null},o.a.createElement(ge,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(be,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},97:function(e,t,n){}},[[236,1,2]]]);
//# sourceMappingURL=main.fb448c3b.chunk.js.map